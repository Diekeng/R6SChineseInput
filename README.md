# R6SChineseInput (R6S 中文输入辅助工具)

<img src="bg.png" width="400" alt="Preview"/>

一个专门为类似《彩虹六号：围攻》(Rainbow Six Siege) 这样的全屏游戏设计的中文输入辅助工具。解决了在某些游戏中无法调出系统输入法候选框、或者游戏原生输入限制导致的输入法无法正常工作的问题。

> ⚠️ **免责声明**：本工具通过 Win32 API 模拟键盘输入实现，其原理类似于外挂/宏工具。**目前尚不明确使用本工具是否会导致游戏封号**，请在充分了解风险后自行决定是否使用。开发者不对因使用本工具导致的任何账号处罚承担责任。

## ✨ 主要功能

*   **无干扰输入**：使用置顶的、半透明的浮动输入框，不破坏游戏画面。
*   **兼容全屏**：支持无边框窗口模式下的游戏输入。
*   **Unicode 支持**：完美支持中文、日文、韩文等 Unicode 字符输入。
*   **按键模拟**：通过底层 Win32 API (`SendInput`) 模拟键盘输入，将文本"打字"到游戏中。
*   **自定义热键**：支持自定义呼出热键（默认 `Ctrl + \``），配置自动保存。
*   **发送重试**：文本发送失败时自动重试，重试次数/间隔/焦点延迟均可在界面中调节。
*   **防多开**：内置单实例检测，防止重复运行。
*   **托盘管理**：支持最小化到系统托盘，后台静默运行。

## 💻 运行环境要求

*   **操作系统**：Windows 10 或 Windows 11 (64位)
*   **运行库**：[.NET 8.0 Desktop Runtime](https://dotnet.microsoft.com/en-us/download/dotnet/8.0) (必须安装 **桌面版** 运行时，仅安装控制台版是不够的)
*   **权限**：必须以 **管理员身份运行** (右键 -> 以管理员身份运行)，否则无法将按键发送到游戏。

## 🎮 游戏设置（重要！）

> ⚠️ 本工具 **不支持** 全屏独占模式！你必须在游戏设置中切换显示模式。

1.  进入游戏 → **设置** → **显示**
2.  将 **显示模式** 设置为 **无边框窗口**（Borderless Window）
3.  保存设置后重启游戏

在全屏独占模式下，本工具的输入框可能无法正常显示在游戏画面上方，且 `SendInput` 模拟输入也可能无法送达游戏窗口。

## 🚀 使用方法

1.  确认游戏已设置为 **无边框窗口** 模式。
2.  **以管理员身份运行** 程序（必须，否则无法向游戏发送按键）。
3.  进入游戏。
4.  按下热键（默认 **Ctrl + `**，即 Esc 下方的波浪号键）呼出输入框。
5.  在输入框中打字（支持使用你习惯的输入法）。
6.  按下 **Enter** 发送文本。
    *   程序会自动隐藏输入框。
    *   自动切换回游戏窗口。
    *   自动将文本发送到游戏聊天框中。
    *   如果发送失败，会自动重试。
7.  按下 **Esc** 可取消输入并隐藏窗口。

## ⚙️ 配置说明

*   **热键设置**：在主界面可以直接修改呼出热键，支持 `Ctrl`, `Alt`, `Shift` 组合键。
*   **发送设置**：在主界面 ⚙️ 发送设置 区域可调节：
    *   **重试次数** — 发送失败后的重试次数（默认 3 次）
    *   **重试间隔** — 每次重试之间的等待时间（默认 100ms）
    *   **焦点延迟** — 焦点归还游戏后、开始发送文本前的等待时间（默认 300ms）
*   **配置文件**：配置文件保存在 `%LocalAppData%\MouseHookApp\config.json`。

## ⚠️ 注意事项

*   **封号风险**：本工具使用 `SendInput` API 模拟键盘输入，该方式与外挂/宏工具原理相同。**目前无法确认是否会被反作弊系统检测或导致封号，请自行承担使用风险。**
*   **无边框窗口**：必须在游戏中选择无边框窗口模式，全屏独占模式不受支持。
*   发送文本时请保持双手离开键盘，以免干扰模拟输入过程。

## 🛠️ 技术栈

*   .NET 8 (WPF)
*   Win32 API (User32.dll, Kernel32.dll)
*   Global Low-level Keyboard Hook (`WH_KEYBOARD_LL`)

---
*Created with ❤️ for gamers. Use at your own risk.*
